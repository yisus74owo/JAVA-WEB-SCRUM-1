<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Inicio de sesi√≥n | OHANA</title>
    <link rel="stylesheet" href="styleslogin.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        // Bloqueo completo del retroceso del navegador (puede ser intrusivo, usar con precauci√≥n)
        history.pushState(null, null, location.href);
        window.onpopstate = function() {
            history.go(1);
            // window.location.reload(true); // Recargar puede no ser siempre lo deseado
        };

        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);

            // Manejar mensaje de error con SweetAlert
            if (urlParams.has('error')) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error de inicio de sesi√≥n',
                    text: 'Correo o contrase√±a incorrectos. Por favor, intente nuevamente.',
                    confirmButtonColor: '#3085d6'
                });
            }

            // Manejar mensaje de logout con SweetAlert
            if (urlParams.has('logout')) {
                Swal.fire({
                    icon: 'success',
                    title: 'Sesi√≥n cerrada',
                    text: 'Has cerrado sesi√≥n correctamente.',
                    confirmButtonColor: '#3085d6',
                    timer: 3000 // El mensaje desaparecer√° despu√©s de 3 segundos
                });
            }

            // Limpiar par√°metros de la URL para evitar que los mensajes se muestren de nuevo al recargar
            if (window.history.replaceState) {
                const cleanUrl = window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);
            }

            // El campo oculto para redirecci√≥n es manejado por el servidor/filtro,
            // no es necesario aqu√≠ a menos que tengas un flujo espec√≠fico de "regresar a la p√°gina anterior".
            // const redirectParam = urlParams.get('redirect');
            // if (redirectParam) {
            //     const redirectInput = document.createElement('input');
            //     redirectInput.type = 'hidden';
            //     redirectInput.name = 'redirect';
            //     redirectInput.value = redirectParam;
            //     document.querySelector('form').appendChild(redirectInput);
            // }
        });

        // Funci√≥n para mostrar/ocultar contrase√±a
        function togglePassword() {
            const passwordInput = document.querySelector('input[name="password"]');
            const toggleBtn = document.querySelector('.toggle-password');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleBtn.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è'; // O un √≠cono diferente para "visible"
            } else {
                passwordInput.type = 'password';
                toggleBtn.textContent = 'üëÅÔ∏è'; // O un √≠cono diferente para "oculto"
            }
        }
    </script>
</head>
<body>
<header>
    <div class="back">
        <div class="menu container">
            <a href="OHANA.html"><img src="images/logo2.png" alt="logo-OHANA" class="logo-ohana"></a>
            <input type="checkbox" id="menu"/>
            <label for="menu">
                <img src="images/menu.jpg" class="menu-icono" alt="Men√∫">
            </label>
            <nav class="navbar">
                <ul>
                    <li><a href="OHANA.html">Inicio</a></li>
                    <li><a href="#servicios">Nosotros</a></li>
                    <li><a href="#contacto">Contacto</a></li>
                    <li><a href="#buscar">Buscar</a></li>
                    <li><a href="login.html" class="active">Inicia Sesi√≥n</a></li>
                    <li><a href="registro.html">Reg√≠strate</a></li>
                </ul>
            </nav>
        </div>
    </div>
</header>

<section class="form-register">
    <h4>Tu compa√±ero fiel te agradece cada visita. Inicia sesi√≥n y sigamos cuidando de √©l.</h4>

    <form method="post" action="LoginServlet" autocomplete="on">
        <div class="form-group">
            <label for="email" class="titulo">Correo electr√≥nico</label>
            <input class="controls" type="email" id="email" name="email" required
                   placeholder="ejemplo@correo.com" autocomplete="username">
        </div>

        <div class="form-group">
            <label for="password">Contrase√±a</label>
            <div class="password-container">
                <input class="controls" type="password" id="password" name="password"
                       required minlength="8" maxlength="16" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                       autocomplete="current-password">
                <button type="button" class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</button>
            </div>
        </div>

        <div class="form-group remember-me">
            <input type="checkbox" id="remember" name="remember">
            <label for="remember" class="custom-checkbox">
                <span class="box"></span>
                Recordar mis datos
            </label>
        </div>

        <div class="form-group">
            <input class="botons" type="submit" value="Iniciar sesi√≥n">
        </div>

        <div class="form-links">
            <p><a href="registro.html">¬øNo tienes una cuenta? Reg√≠strate</a></p>
            <p><a href="restaurar.html">¬øOlvidaste tu contrase√±a?</a></p>
        </div>
    </form>
</section>

</body>
</html>